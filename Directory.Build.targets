<Project>

  <PropertyGroup>
    <!-- Disable the preview warning when building -->
    <_NETCoreSdkIsPreview>false</_NETCoreSdkIsPreview>

    <LangVersion Condition="'$(Language)' == 'C#'">Latest</LangVersion>
  </PropertyGroup>

  <!-- 
    This is set for projects which host the VimSpecific project as a part 
    test hosting: VimApp or VimTestUtils
    -->
  <PropertyGroup Condition="'$(VsVimSpecificTestHost)' == 'true'">
    <DefineConstants Condition="'$(VsVimTargetVersion)' == '14.0'">$(DefineConstants);VS_SPECIFIC_2015;VIM_SPECIFIC_TEST_HOST</DefineConstants>
    <DefineConstants Condition="'$(VsVimTargetVersion)' == '15.0'">$(DefineConstants);VS_SPECIFIC_2017;VIM_SPECIFIC_TEST_HOST</DefineConstants>
    <!-- hack: force to 2022 instead of fixing the target version <DefineConstants Condition="'$(VsVimTargetVersion)' == '16.0'">$(DefineConstants);VS_SPECIFIC_2019;VIM_SPECIFIC_TEST_HOST</DefineConstants> -->
    <DefineConstants Condition="'$(VsVimTargetVersion)' == '16.0'">$(DefineConstants);VS_SPECIFIC_2022;VIM_SPECIFIC_TEST_HOST</DefineConstants>
    <DefineConstants Condition="'$(VsVimTargetVersion)' == '17.0'">$(DefineConstants);VS_SPECIFIC_2022;VIM_SPECIFIC_TEST_HOST</DefineConstants>
  </PropertyGroup>

  <Import Project="$(VsRunnablePropsFilePath)" Condition="'$(VsVimIsRunnable)' == 'true' And '$(VsRunnablePropsFilePath)' != ''" />

  <Import Project="$(VsSDKInstall)\Microsoft.VsSDK.targets" Condition="Exists('$(VsSDKInstall)\Microsoft.VsSDK.targets') and '$(IsVsixProject)' == 'true'" />
</Project>
